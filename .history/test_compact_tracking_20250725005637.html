<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compact Eye Tracking Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="text-white">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold mb-6">Compact Eye Tracking Test</h1>
        <p class="text-lg mb-4">Testing the smaller interface with optimized live feed...</p>
        
        <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6">
            <h2 class="text-xl font-semibold mb-4">Service Status</h2>
            <div id="status-display" class="text-sm">
                Checking service connection...
            </div>
        </div>

        <div class="mt-6">
            <h3 class="text-lg font-semibold mb-2">Testing Features:</h3>
            <ul class="list-disc list-inside space-y-1 text-sm">
                <li>‚úÖ Compact interface (180px width instead of 240px)</li>
                <li>‚úÖ Smaller video feed (100px height instead of 140px)</li>
                <li>‚úÖ Optimized frame rate (150ms instead of 200ms)</li>
                <li>‚úÖ Compressed video quality for performance</li>
                <li>‚úÖ Reduced padding and smaller indicators</li>
            </ul>
        </div>
    </div>

    <script src="user/js/cv-eye-tracking.js"></script>
    <script>
        // Initialize the compact eye tracking system
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Initializing Compact Eye Tracking System...');
            
            const statusDisplay = document.getElementById('status-display');
            statusDisplay.innerHTML = 'Checking Python service...';
            
            try {
                // Check service health
                const healthResponse = await fetch('http://127.0.0.1:5000/api/health');
                if (healthResponse.ok) {
                    const healthData = await healthResponse.json();
                    console.log('‚úÖ Service health check passed:', healthData);
                    statusDisplay.innerHTML = `
                        <div class="text-green-400">‚úÖ Service Connected</div>
                        <div class="text-sm mt-1">Status: ${healthData.status}</div>
                        <div class="text-sm">Python Version: ${healthData.python_version}</div>
                        <div class="text-sm">Service Version: ${healthData.service_version}</div>
                    `;
                    
                    // Initialize eye tracking with compact interface
                    const eyeTracker = new CVEyeTrackingSystem();
                    
                    // Set test parameters
                    eyeTracker.moduleId = 'test_module_compact';
                    eyeTracker.sectionId = 'test_section_compact';
                    
                    // Initialize and start automatically
                    await eyeTracker.initialize();
                    
                    console.log('üéØ Compact eye tracking system initialized successfully');
                    
                } else {
                    statusDisplay.innerHTML = '<div class="text-red-400">‚ùå Service connection failed</div>';
                }
            } catch (error) {
                console.error('Service initialization error:', error);
                statusDisplay.innerHTML = `<div class="text-red-400">‚ùå Error: ${error.message}</div>`;
            }
        });
    </script>
</body>
</html>
